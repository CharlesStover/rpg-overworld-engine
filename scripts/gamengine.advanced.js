var c=!0,e=null,i=!1;window.d=window.soundManager;$=window.$;$.g=$.fn;Array.prototype.contains=function(a){if("object"==typeof a){for(var b=0;b<a.length;b++)if(this.contains(a[b]))return c;return i}for(b=0;b<this.length;b++)if(this[b]===a)return c;return i};Array.prototype.remove=function(a){for(var b=0;b<this.length;b++)this[b]===a&&(this.splice(b,1),b--);return this};
$.g.scroll=function(a,b,f,h){var g=this.a("background-position").match(/^(\-?[\d\.]+)(?:px)?\s+(\-?[\d\.]+)(?:px)?$/);g[1]=parseFloat(g[1]);g[2]=parseFloat(g[2]);"number"==typeof f&&(g[1]>f?g[1]-=f:g[1]<-1*f&&(g[1]+=f));"number"==typeof h&&(g[2]>h?g[2]-=h:g[2]<-1*h&&(g[2]+=h));return this.scrollTo(g[1]+a,g[2]+b)};$.g.scrollTo=function(a,b){return this.a("background-position",a+"px "+b+"px")};
$.g.z=function(){var a=j.width()/2-8,b=j.height()/2-8;if(this.length){var f=this.a("left"),h=this.a("top"),f=parseFloat(("auto"==f?"0":f).match(/^(\-?[\d\.]+)(?:px)?/)[1]),h=parseFloat(("auto"==h?"0":h).match(/^(\-?[\d\.]+)(?:px)?/)[1]);return this.A(f+a,h+b)}};$.g.A=function(a,b){return this.a({left:a+"px",top:b+"px"})};var k=$("#debug > div");$("#debug");$(document);var j=$("#gamengine");$("head");$(window);var l,m,n=[{}];
function o(){if(!p("message","preload")){q.p=c;l=arguments[arguments.length-1];r=[];for(var a=0;a<arguments.length-1;a++)r.push(arguments[a]);s("Creating choice menu: "+r.join(", "));a=$(document.createElement("ul")).e("choice").a({zIndex:1E3*u[v].j.length}).h('<li class="selected">'+r.join("</li><li>")+"</li>");j.append(a)}}var r,w,y,z;
function s(a){if(q.debug){if("object"==typeof a){var b=0,f=a,h=0,a=[],g=[],t;for(t in f)"function"!=typeof f[t]&&(h++,t.match(/^\d+$/)&&(b++,g.push(f[t])),a.push(t+": "+f[t]));a=b==h?g.join(", "):a.join(",<br />")}a+="<br />";k.append("boolean"==typeof a?a?"true":"false":a);k.parent().scrollTop(k.height())}}var q={debug:c,c:i,map:i,message:i,k:i,step:i,P:i};
function A(a){if("undefined"==typeof a){var b=$(".choice li.selected").h();$(".choice").remove();s("Choice selected: "+b);l(b);q.p=i;return b}if(a==e)return $(".choice li.selected").l("selected").m().u().e("selected"),A();"undefined"==typeof w?w=a:w!=a&&(w=a,clearTimeout(B));b=$(".choice .selected");38==a?(a=b.L(),a.length||(a=b.m().u())):(a=b.next(),a.length||(a=b.m().G()));b.l("selected");a.e("selected");B=setTimeout(function(){if(C[w])A(w);else if(C[w==38?40:38])A(w==38?40:38)},200);return a.h()}
function D(a){if("object"==typeof n[0]){var b=n[0].direction;b.contains(a)||b.push(a);p("preload","step")||n[0].step()}}function E(a){"object"==typeof n[0]&&n[0].direction.remove(a)}function p(){for(var a=0;a<arguments.length;a++)if("boolean"==typeof q[arguments[a]]&&q[arguments[a]])return c;return i}
var C=[],L={13:function(){if(p("choice"))return A();if(p("message"))return F();o("Controls","Save","Options","Reset","Close",function(a){"Controls"==a?F("Arrow keys allow you to move.","Hold S to run.","Press D to interact with people, your environment, and messages.","Press 0 to mute or unmute the game.","Press - to decrease and = to increase the volume.","Press R to reload the game.","Press Enter to open the menu."):"Save"==a?F("Saving has not been programmed yet."):"Options"==a?F("Options have not been programmed yet."):
"Reset"==a&&location.reload()})},32:function(){if(p("choice"))return A()},37:function(a){return D(a)},38:function(a){return p("choice")?A(38):D(a)},39:function(a){return D(a)},40:function(a){return p("choice")?A(40):D(a)},48:function(){G?H&&(G=i,soundManager.K(),s("Muted.")):H&&(G=c,soundManager.O(),s("Unmuted."))},68:function(){if(p("message"))F();else if(p("choice"))A();else{a:if(!p("interact","preload")){for(var a=1;a<n.length;a++)if(n[a].position[0]==Math.round(n[0].position[0]-Math.sin(n[0].b*
Math.PI/2))&&n[a].position[1]==Math.round(n[0].position[1]+Math.cos(n[0].b*Math.PI/2))&&"function"==typeof n[a].i){n[0].stop();q.c=n[a].i();"undefined"==typeof q.c&&(q.c=i);break a}var b=u[v].i,a=Math.round(n[0].position[1]+1+Math.cos(n[0].b*Math.PI/2));a in b&&(b=b[a],a=Math.round(n[0].position[0]+1+-1*Math.sin(n[0].b*Math.PI/2)),a in b&&(b=b[a],"object"==typeof b&&(b=b[n[0].b+(2<n[0].b?-3:1)]),"function"==typeof b&&(n[0].stop(),q.c=b(),"undefined"==typeof q.c&&(q.c=i))))}I({keyCode:68})}},82:function(){window.location.reload()},
83:function(){n[0].w=c;p("choice")?A(e):p("message")?F():"Phantom"==n[0].f&&n[0].o&&(n[0].t=c,n[0].q(),J=setTimeout("GAME.keys.up({keyCode: 83});",n[0].speed.s))},107:function(){K(25)},109:function(){K(-25)}},M={37:function(a){return E(a)},38:function(a){return p("choice")?clearTimeout(B):E(a)},39:function(a){return E(a)},40:function(a){return p("choice")?clearTimeout(B):E(a)},83:function(){n[0].w=i;"Phantom"==n[0].f&&(n[0].o=i,n[0].t=i,n[0].q(),clearTimeout(J),setTimeout("GAME.characters[0].canBeInvisible = true;",
n[0].F.s))}};function N(a){if(!C[a.keyCode]&&(C[a.keyCode]=c,"function"==typeof L[a.keyCode]))L[a.keyCode](a.keyCode)}function I(a){C[a.keyCode]=i;if("function"==typeof M[a.keyCode])M[a.keyCode](a.keyCode)}function O(){var a={f:"Red",b:3,name:"Charles Stover",position:[2,6]};this.v();this.C.M(this.v);this.D[0]=a;this.map.load("room1",a.position[0],a.position[1]);this.n.I(N);this.n.J(I)}var v=e,u={};
function F(){if(!$(".message").H("hidden")){$(".message").remove();if("undefined"==typeof arguments[0]&&"undefined"==typeof y[0])return q.message=i,"function"==typeof m&&(s("Executing message callback."),m()),c;if(arguments.length){q.message=c;var a=arguments;"object"==typeof a[0]&&(a=a[0]);y=[];z="number"==typeof a[0]?a[0]:e;m=e;for(var b=z!=e?1:0;b<a.length;b++)"function"==typeof a[b]?m=a[b]:y.push(a[b]);s("Created "+y.length+" message"+(1!=y.length?"s":"")+(z!=e?" for character #"+z:"")+("function"==
typeof m?" with callback":"")+".")}var a=y.shift(),f=$('<div class="message"><div>'+a+"</div></div>").a({zIndex:1E3*u[v].j.length});z!=e&&f.e("hidden");z!=e&&f.e(n[z].f).a({backgroundColor:"#"+n[z].background,borderColor:"#"+n[z].r,color:"#"+n[z].r});j.append(f);if(z!=e){var h=P+"images/message/"+n[z].f+"/"+n[z].background+"-"+f.height()+".jpg";Q(h,function(){f.a("background-image",'url("'+h+'")');f.l("hidden")})}return c}return i}var R=e;function S(){q.k=i;"function"==typeof R&&R()}var T=[];
function Q(){U=[];for(var a=e,b=0;b<arguments.length;b++)"function"==typeof arguments[b]?a=arguments[b]:T.contains(arguments[b])||U.push(arguments[b]);R=a;if(U.length){q.k=c;V=0;j.append('<div id="preloader-area"></div><img alt="Loading..." height="16" id="preloader-quick" src="./images/preloader/quick7.gif" width="16" />');W=$("#preloader-area");X=$("#preloader-quick").a({zIndex:1E3*u[v].j.length}).z();for(b=0;b<U.length;b++)s('Quick loading image: <a href="'+U[b]+'">'+U[b].replace(RegExp("^"+P.replace(/\./g,
"\\.").replace(/\//g,"\\/")),"./")+"</a>"),a=document.createElement("img"),a.onload=aa,a.setAttribute("src",U[b]),W.append(a)}else S()}function aa(){T.push(U[V]);V++;V==U.length&&(W.remove(),X.remove(),S())}var V=0,U=[],W,X,G=i,H=i;function K(a){var b=Y;Y+=a;Y=Math.min(Math.max(Y,0),100);if(Y!=b){s((0>a?"De":"In")+"creasing volume to "+Y+"%.");for(a=0;a<soundManager.B.length;a++)soundManager.N(soundManager.B[a],Y)}}
var Y=100,Z=e,B,J,P=(location.href.match(/^file\:\/\/\/C\:\/Websites\//)?location.href.replace(/^file\:\/\/\/C\:\/Websites\//,"http://127.0.0.1/").match(/(.*)\/[\-\w]*/)[1]:".")+"/",Z=function(){O()};window.d.debugMode=i;window.d.flashVersion=8;window.d.onready(function(){s("Sound Manager loaded.");H=G=c;s("Engine starting.");Z()});window.d.ontimeout(function(){s('<strong class="error">Error loading Sound Manager.</strong>');H=G=i;Z()});window.d.url="./scripts/";window.d.useFlashBlock=i;