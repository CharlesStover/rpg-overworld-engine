/***********************************************\
|*                                             *|
|*   Copyright (c) 2011-2012, Charles Stover   *|
|*             All Rights Reserved             *|
|*                                             *|
\***********************************************/

var fileSizeDotPhpSizes={"./images/characters/33/pokemon/grandma.gif":1300.48,"./images/characters/33/pokemon/leaf.gif":2211.84,"./images/characters/33/pokemon/red.gif":2191.36,"./images/characters/66/pokemon/grandma.gif":1228.8,"./images/characters/66/pokemon/leaf.gif":2078.72,"./images/characters/66/pokemon/red.gif":2140.16,"./images/characters/75/pokemon/grandma.gif":1228.8,"./images/characters/75/pokemon/leaf.gif":2078.72,"./images/characters/75/pokemon/red.gif":2140.16,"./images/characters/100/pokemon/grandma.gif":1208.32,
"./images/characters/100/pokemon/leaf.gif":2058.24,"./images/characters/100/pokemon/red.gif":2119.68,"./images/choice/arrow.gif":56,"./images/choice/arrow-selected.gif":56,"./images/maps/33/oaks.png":7321.6,"./images/maps/33/pallet.png":24371.2,"./images/maps/33/room1.png":7536.64,"./images/maps/33/room2.png":8622.08,"./images/maps/33/overlays/oaks.png":905,"./images/maps/33/overlays/pallet.png":4044.8,"./images/maps/33/overlays/room1.png":614,"./images/maps/33/overlays/room2-1.png":432,"./images/maps/33/overlays/room2-2.png":433,
"./images/maps/66/oaks.png":7321.6,"./images/maps/66/pallet.png":24371.2,"./images/maps/66/room1.png":7536.64,"./images/maps/66/room2.png":8622.08,"./images/maps/66/overlays/oaks.png":905,"./images/maps/66/overlays/pallet.png":4044.8,"./images/maps/66/overlays/room1.png":614,"./images/maps/66/overlays/room2-1.png":432,"./images/maps/66/overlays/room2-2.png":433,"./images/maps/75/oaks.png":7321.6,"./images/maps/75/pallet.png":24371.2,"./images/maps/75/room1.png":7536.64,"./images/maps/75/room2.png":8622.08,
"./images/maps/75/overlays/oaks.png":905,"./images/maps/75/overlays/pallet.png":4044.8,"./images/maps/75/overlays/room1.png":614,"./images/maps/75/overlays/room2-1.png":432,"./images/maps/75/overlays/room2-2.png":433,"./images/maps/100/oaks.png":7321.6,"./images/maps/100/pallet.png":24371.2,"./images/maps/100/room1.png":7536.64,"./images/maps/100/room2.png":8622.08,"./images/maps/100/overlays/oaks.png":905,"./images/maps/100/overlays/pallet.png":4044.8,"./images/maps/100/overlays/room1.png":614,"./images/maps/100/overlays/room2-1.png":432,
"./images/maps/100/overlays/room2-2.png":433,"./images/message/Grandma/c0c0c0-45.jpg":1413.12,"./images/message/Grandma/c0c0c0-65.jpg":2109.44,"./images/message/Grandma/c0c0c0-66.jpg":2129.92,"./images/message/Grandma/ffffff-45.jpg":1423.36,"./images/message/Grandma/ffffff-66.jpg":2119.68,"./images/message/Leaf/d8ffd8-19.jpg":921,"./images/message/Leaf/d8ffd8-45.jpg":1423.36,"./images/message/Leaf/ffffff-45.jpg":1423.36,"./images/notice/music/000000.gif":303,"./images/preloader/bar.gif":151,"./images/preloader/item.gif":211,
"./images/preloader/quick7.gif":2938.88,"./images/preloader/round.gif":208,"./images/say/corner/000000-ffffff.gif":75,"./images/say/corner/808080-000000.gif":75,"./images/say/corner/909090-000000.gif":75,"./images/say/corner/a0a0a0-000000.gif":75,"./images/say/corner/a0a0a0-ff0000.gif":75,"./images/say/corner/c0c0c0-000000.gif":75,"./images/say/corner/d0d0d0-000000.gif":75,"./images/say/corner/d8ffd8-000000.gif":75,"./images/say/corner/e0e0e0-000000.gif":75,"./images/say/corner/f0f0f0-000000.gif":75,
"./images/say/corner/ff0000-0000ff.gif":75,"./images/say/corner/ffffff-000000.gif":75,"./images/say/horizontal/000000-ffffff.gif":36,"./images/say/horizontal/808080-000000.gif":36,"./images/say/horizontal/909090-000000.gif":36,"./images/say/horizontal/a0a0a0-000000.gif":36,"./images/say/horizontal/a0a0a0-ff0000.gif":36,"./images/say/horizontal/c0c0c0-000000.gif":36,"./images/say/horizontal/d0d0d0-000000.gif":36,"./images/say/horizontal/d8ffd8-000000.gif":36,"./images/say/horizontal/f0f0f0-000000.gif":36,
"./images/say/horizontal/ff0000-0000ff.gif":36,"./images/say/horizontal/ffffff-000000.gif":36,"./images/say/stem/808080-000000.gif":161,"./images/say/stem/909090-000000.gif":161,"./images/say/stem/c0c0c0-000000.gif":161,"./images/say/stem/d8ffd8-000000.gif":161,"./images/say/stem/f0f0f0-000000.gif":161,"./images/say/stem/ffffff-000000.gif":161,"./images/say/vertical/000000-ffffff.gif":36,"./images/say/vertical/808080-000000.gif":36,"./images/say/vertical/909090-000000.gif":36,"./images/say/vertical/a0a0a0-000000.gif":36,
"./images/say/vertical/a0a0a0-ff0000.gif":36,"./images/say/vertical/c0c0c0-000000.gif":36,"./images/say/vertical/d0d0d0-000000.gif":36,"./images/say/vertical/d8ffd8-000000.gif":36,"./images/say/vertical/f0f0f0-000000.gif":36,"./images/say/vertical/ff0000-0000ff.gif":36,"./images/say/vertical/ffffff-000000.gif":36,"./sound/music/by/_Jensan/Retro.mp3":963584,"./sound/music/by/_Paulius_Jurgelevicius/Fast.mp3":189440,"./sound/music/by/_YD/Remember_Winter.mp3":1154048,"./sound/music/by/Raivu/Macrocosmos.mp3":1918894.08},
fileSizeDotPhp=function(a){return[a,Object.prototype.hasOwnProperty.call(fileSizeDotPhpSizes,a)?fileSizeDotPhpSizes[a]:0]};Array.prototype.contains=function(a){if("object"==typeof a){for(var b=0;b<a.length;b++)if(this.contains(a[b]))return!0;return!1}for(b=0;b<this.length;b++)if(this[b]===a)return!0;return!1};Array.prototype.pushUnique=function(a){this.contains(a)||this.push(a);return this};Array.prototype.remove=function(a){for(var b=0;b<this.length;b++)this[b]===a&&(this.splice(b,1),b--);return this};
$.fn.boxShadow=function(a,b,c,d){return $.browser.msie?this.each(function(){$(this).css({position:"relative",zoom:1,zIndex:"2"});$(this).parent().css("position","relative");var e=document.createElement("div");$(this).parent().append(e);var f=$(this).outerHeight(),g=a,h=b,k=$(this).outerWidth();0!=c&&($(e).css("filter","progid:DXImageTransform.Microsoft.Blur(pixelRadius="+c+", enabled='true')"),f+=1,g-=c+1,h-=c+1,k+=1);$(e).css({backgroundColor:d,height:f+"px",left:g+"px",position:"absolute",top:h+
"px",width:k+"px",zIndex:1})}):this};$.fn.scroll=function(a,b,c,d){var e=this.css("background-position")||"0 0";e=e.match(/^(\-?[\d\.]+)(?:px)?\s+(\-?[\d\.]+)(?:px)?$/);e[1]=parseFloat(e[1]);e[2]=parseFloat(e[2]);"number"==typeof c&&(e[1]>c?e[1]-=c:e[1]<-1*c&&(e[1]+=c));"number"==typeof d&&(e[2]>d?e[2]-=d:e[2]<-1*d&&(e[2]+=d));return this.scrollTo(e[1]+a,e[2]+b)};$.fn.scrollTo=function(a,b){return this.css("background-position",a+"px "+b+"px")};
$.fn.slide=function(a,b){if(this.length){var c=this.css("left"),d=this.css("top");c=parseFloat(("auto"==c?"0":c).match(/^(\-?[\d\.]+)(?:px)?/)[1]);d=parseFloat(("auto"==d?"0":d).match(/^(\-?[\d\.]+)(?:px)?/)[1]);return this.slideTo(c+a,d+b)}};$.fn.slideTo=function(a,b){return this.css({left:a+"px",top:b+"px"})};
var GAME={$debug:$("#debug > div"),$debugWrapper:$("#debug"),$document:$(document),$gamengine:$("#gamengine"),$head:$("head"),$notice:null,$preloader:null,$window:$(window),callbacks:{},character:function(a,b){b="undefined"!=typeof b?b:!1;GAME.debug("Creating "+(b?"player":"character #"+GAME.characters.length)+("undefined"!=typeof a.character?": "+a.character:"."));"number"==typeof b&&0 in GAME.characters&&"direction"in GAME.characters[0]||(a=$.extend(!0,{background:"ffffff",callbacks:{},canBeInvisible:!1,
character:"NPC",cooldowns:{},direction:[],directionForce:[],displayStep:function(){GAME.functions.displayStep(this.id)},facePlayer:function(){GAME.functions.facePlayer(this.id)},facing:4,foot:0,foreground:"000000",height:16,image:"none",invisible:!1,loaded:null,message:function(){for(var a=[this.id],b=0;b<arguments.length;b++)a.push(arguments[b]);GAME.message(a)},name:"Anonymous",offset:[0,0],position:[0,0],running:!1,say:function(){GAME.say(this.id,arguments,0)},speed:{run:500,walk:1E3},step:function(){for(var a=
0;a<arguments.length;a++)"function"==typeof arguments[a]?this.callbacks.step=arguments[a]:this.directionForce.unshift(arguments[a]);GAME.functions.step(this.id)},stop:function(){this.direction=[];this.foot%2&&(this.foot=(this.foot+1)%4);this.$.scrollTo(0,-1*(4-this.facing)*this.height)},timeouts:{},width:16},"undefined"!=typeof a.character&&"undefined"!=typeof GAME.characterSettings[a.character]?GAME.characterSettings[a.character]:{},a));a.id="number"==typeof b?0:GAME.characters.length;var c='<div class="character" id="character-'+
a.id+'"></div>';"number"==typeof b?GAME.$gamengine.append(c):GAME.characters[0].$.after(c);a.$=$("#character-"+a.id);GAME.preloader.quick(GAME.url+"images/characters/"+GAME.timeOfDay(!0)+"/"+a.image,function(){a.$.css({backgroundImage:"none"==a.image?"none":'url("'+GAME.url+"images/characters/"+GAME.timeOfDay(!0)+"/"+a.image+'")',backgroundPosition:"0 "+-1*(4-a.facing)*a.height+"px",height:a.height.toString()+"px",left:(320-Math.round(a.width/2)+a.offset[0]+("number"==typeof b?0:(a.position[0]-GAME.characters[0].position[0])*
GAME.map.maps[GAME.map.current].block)).toString()+"px",marginBottom:"-"+a.height.toString()+"px",top:(240-Math.round(a.height/2)+a.offset[1]+("number"==typeof b?0:(a.position[1]-GAME.characters[0].position[1])*GAME.map.maps[GAME.map.current].block)).toString()+"px",width:a.width.toString()+"px",zIndex:1E3*("number"==typeof b?b:Math.floor(parseFloat(GAME.characters[0].$.css("z-index").toString().match(/[\-\d]+/)[0])/1E3))+a.position[1]});GAME.characters[a.id]=a;"function"==typeof GAME.characters[a.id].loaded&&
(GAME.debug("Executing character callback."),GAME.characters[a.id].loaded(a.id))});return a.id},characters:[{}],characterSettings:{Grandma:{background:"c0c0c0",foreground:"000000",height:21,image:"pokemon/grandma.gif",offset:[0,-2],speed:{run:null,walk:750},width:16},Janus:{height:24,image:"chrono-trigger/janus.gif",offset:[0,-2],speed:{run:null,walk:250},width:14},Leaf:{background:"d8ffd8",foreground:"000000",height:21,image:"pokemon/leaf.gif",offset:[0,-2],speed:{run:150,walk:250},width:16},Red:{height:21,
image:"pokemon/red.gif",offset:[0,-2],speed:{run:150,walk:250},width:16},Schala:{height:31,image:"chrono-trigger/schala.gif",offset:[0,-2],speed:{run:null,walk:250},width:16},Tata:{height:24,image:"chrono-trigger/tata.gif",offset:[-1,-2],speed:{run:null,walk:250},width:18},Toma:{height:32,image:"chrono-trigger/toma.gif",offset:[-1,-2],speed:{run:null,walk:250},width:18}},choice:function(){if(!GAME.is("message","preload")){GAME.doing.choice=!0;GAME.callbacks.choice=arguments[arguments.length-1];GAME.data.choices=
[];for(var a=0;a<arguments.length-1;a++)GAME.data.choices.push(arguments[a]);GAME.debug("Creating choice menu: "+GAME.data.choices.join(", "));a=$(document.createElement("ul")).addClass("choice").css({zIndex:1E3*GAME.map.maps[GAME.map.current].overlays.length}).html('<li class="selected">'+GAME.data.choices.join("</li><li>")+"</li>");GAME.$gamengine.append(a);return!0}return!1},credits:function(a){GAME.doing.preload=!0;GAME.$gamengine.empty();GAME.$gamengine.append('<div id="credits"></div>');GAME.credit=
0;GAME.$credits=$("#credits");GAME.$$credits=[];GAME.map.clearTimeouts();GAME.sound.stop();GAME.sound.play(a);for(var b=1;b<arguments.length;b++)GAME.$credits.append('<div id="credits-'+b+'">'+arguments[b]+"</div>"),GAME.$$credits[b-1]=$("#credits-"+b),GAME.$$credits[b-1].fadeTo(0,0),setTimeout(function(){GAME.$$credits[GAME.credit].css("top",(480-GAME.$$credits[GAME.credit].height())/2+"px");GAME.$$credits[GAME.credit].fadeTo(1E3,1,function(){setTimeout(function(){GAME.credit!=GAME.$$credits.length-
1&&GAME.$$credits[GAME.credit].fadeTo(1E3,0,function(){GAME.$$credits[GAME.credit-1].remove()});GAME.credit++},3E3)})},5E3*(b-1))},data:{},debug:function(a){if(GAME.doing.debug){if("object"==typeof a){var b=0,c=0,d=[],e=[],f;for(f in a)"function"!=typeof a[f]&&(c++,f.match(/^\d+$/)&&(b++,e.push(a[f])),d.push(f+": "+a[f]));d=b==c?e.join(", "):d.join(",<br />")}else d="boolean"==typeof a?a?"true":"false":a;GAME.$debug.append(d+"<br />");GAME.$debug.parent().scrollTop(GAME.$debug.height())}},doing:{debug:!0,
interact:!1,map:!1,message:!1,preload:!1,step:!1},format:function(a){a=a.toString();for(var b="",c=0;c<a.length;c++)b=a.charAt(a.length-1-c)+(0<c&&!(c%3)?",":"")+b;return b},functions:{choice:function(a){if("undefined"==typeof a){var b=$(".choice li.selected").html();$(".choice").remove();GAME.debug("Choice selected: "+b);GAME.callbacks.choice(b);GAME.doing.choice=!1;return b}if(null==a)return $(".choice li.selected").removeClass("selected").siblings().last().addClass("selected"),GAME.functions.choice();
"undefined"==typeof GAME.data.lastChoiceDirection?GAME.data.lastChoiceDirection=a:GAME.data.lastChoiceDirection!=a&&(GAME.data.lastChoiceDirection=a,clearTimeout(GAME.timeouts.choice));b=$(".choice .selected");38==a?(a=b.prev(),a.length||(a=b.siblings().last())):(a=b.next(),a.length||(a=b.siblings().first()));b.removeClass("selected");a.addClass("selected");GAME.timeouts.choice=setTimeout(function(){GAME.keys.active[GAME.data.lastChoiceDirection]?GAME.functions.choice(GAME.data.lastChoiceDirection):
GAME.keys.active[38==GAME.data.lastChoiceDirection?40:38]&&GAME.functions.choice(38==GAME.data.lastChoiceDirection?40:38)},200);return a.html()},direction:{down:function(a){"object"==typeof GAME.characters[0]&&"direction"in GAME.characters[0]&&(GAME.characters[0].direction.pushUnique(a),GAME.is("preload","step")||GAME.characters[0].step())},up:function(a){"object"==typeof GAME.characters[0]&&"direction"in GAME.characters[0]&&GAME.characters[0].direction.remove(a)}},displayStep:function(a){GAME.characters[a].$.scrollTo(-1*
((GAME.characters[a].running?3:0)+GAME.characters[a].foot%2+(3==GAME.characters[a].foot?1:0))*GAME.characters[a].width,-1*(4-GAME.characters[a].facing)*GAME.characters[a].height)},enter:function(a,b){var c=GAME.map.maps[GAME.map.current].enter[b+1][a+1];"object"==typeof c&&(c=c[GAME.characters[0].facing-1]);"string"==typeof c&&(c=GAME.map.maps[GAME.map.current].functions[c]);return"function"==typeof c?(c(),!0):!1},facePlayer:function(a){GAME.characters[a].facing=GAME.characters[0].facing+(3>GAME.characters[0].facing?
2:-2);GAME.characters[a].displayStep()},interact:function(){if(!GAME.is("interact","preload")){for(var a=1;a<GAME.characters.length;a++)if(GAME.characters[a].position[0]==Math.round(GAME.characters[0].position[0]-Math.sin(GAME.characters[0].facing*Math.PI/2))&&GAME.characters[a].position[1]==Math.round(GAME.characters[0].position[1]+Math.cos(GAME.characters[0].facing*Math.PI/2))&&"function"==typeof GAME.characters[a].interaction)return GAME.characters[0].stop(),GAME.doing.interact=GAME.characters[a].interaction(),
"undefined"==typeof GAME.doing.interact&&(GAME.doing.interact=!1),!0;var b=GAME.map.maps[GAME.map.current].interaction;a=Math.round(GAME.characters[0].position[1]+1+Math.cos(GAME.characters[0].facing*Math.PI/2));if(a in b&&(b=b[a],a=Math.round(GAME.characters[0].position[0]+1+-1*Math.sin(GAME.characters[0].facing*Math.PI/2)),a in b&&(b=b[a],"object"==typeof b&&(b=b[GAME.characters[0].facing+(2<GAME.characters[0].facing?-3:1)]),"function"==typeof b)))return GAME.characters[0].stop(),GAME.doing.interact=
b(),"undefined"==typeof GAME.doing.interact&&(GAME.doing.interact=!1),!0}return!1},step:function(a){var b=null;"undefined"!=typeof GAME.characters[a].directionForce[0]?GAME.is("choice","message","preload")||(b=GAME.characters[a].directionForce.pop()):GAME.is("choice","message","preload","step")||(GAME.doing.step=!0,b=GAME.characters[0].direction[GAME.characters[0].direction.length-1],b=[37,65].contains(b)?1:[38,87].contains(b)?2:[39,68].contains(b)?3:4);if(null!=b){GAME.characters[a].facing=b;GAME.characters[a].foot=
(GAME.characters[a].foot+1)%4;GAME.characters[a].displayStep();var c=[GAME.characters[a].position[0]+(1==b?-1:3==b?1:0),GAME.characters[a].position[1]+(2==b?-1:4==b?1:0)],d=GAME.map.maps[GAME.map.current].blocked;"object"==typeof d[c[1]+1]?(d=d[c[1]+1][c[0]+1],"object"==typeof d&&(d=d[(b+1)%4])):d=1;for(var e=0;e<GAME.characters.length;e++)if(GAME.characters[e].position[0]==c[0]&&GAME.characters[e].position[1]==c[1]){d=1;break}if(d)0==a?setTimeout("GAME.doing.step = false;",GAME.characters[0].speed[GAME.characters[0].running?
"run":"walk"]):GAME.characters[a].directionForce.push(b);else{GAME.characters[a].$.css("z-index",1E3*Math.floor(parseFloat(GAME.characters[a].$.css("z-index").toString().match(/[\-\d]+/)[0])/1E3)+c[1]);d=b*Math.PI/2;var f=e=0;0==a?(e=Math.sin(d),f=-1*Math.cos(d)):(e=-1*Math.sin(d),f=Math.cos(d));e=Math.round(e);f=Math.round(f);GAME.characters[a].position=[c[0],c[1]];GAME.characters[a].offset[0]+=GAME.map.maps[GAME.map.current].block*e*-1;GAME.characters[a].offset[1]+=GAME.map.maps[GAME.map.current].block*
f*-1;for(d=0;d<GAME.map.maps[GAME.map.current].block;d++)0==a?setTimeout(function(){GAME.characters[0].offset[0]+=e;GAME.characters[0].offset[1]+=f;for(var a=GAME.map.maps[GAME.map.current].overlays,b=0;b<a.length;b++)"object"==typeof a[b]&&a[b].$.scroll(a[b].parallax[0]*e,a[b].parallax[1]*f);$(".say:not(.say-0)").slide(e,f);for(b=1;b<GAME.characters.length;b++)GAME.characters[b].$.slide(e,f)},d*GAME.characters[0].speed[GAME.characters[0].running?"run":"walk"]/GAME.map.maps[GAME.map.current].block):
GAME.characters[a].timeouts["step"+d]=setTimeout(function(){GAME.characters[a].offset[0]+=e;GAME.characters[a].offset[1]+=f;GAME.characters[a].$.slide(e,f);$(".say-"+a).slide(e,f)},d*GAME.characters[a].speed[GAME.characters[a].running?"run":"walk"]/GAME.map.maps[GAME.map.current].block);0==a&&setTimeout("GAME.doing.step = false; GAME.functions.enter("+c[0]+", "+c[1]+");",GAME.characters[0].speed[GAME.characters[0].running?"run":"walk"])}}GAME.characters[a].timeouts.step=setTimeout(function(){GAME.characters[a].direction.length||
GAME.characters[a].directionForce.length?GAME.characters[a].step():(GAME.characters[a].stop(),"function"==typeof GAME.characters[a].callbacks.step&&GAME.characters[a].callbacks.step())},null==b?50:GAME.characters[a].speed[GAME.characters[a].running?"run":"walk"])}},is:function(){for(var a=0;a<arguments.length;a++)if("boolean"==typeof GAME.doing[arguments[a]]&&GAME.doing[arguments[a]])return!0;return!1},keys:{active:[],binds:{down:{13:function(){if(GAME.is("choice"))return GAME.functions.choice();
if(GAME.is("message"))return GAME.message();GAME.choice("Controls","Save","Options","Reset","Close",function(a){"Controls"==a?GAME.message("Arrow keys allow you to move.","Hold S to run.","Press D to interact with people, your environment, and messages.","Press 0 to mute or unmute the game.","Press - to decrease and = to increase the volume.","Press R to reload the game.","Press Enter to open the menu."):"Save"==a?GAME.message("Saving has not been programmed yet."):"Options"==a?GAME.message("Options have not been programmed yet."):
"Reset"==a&&location.reload()})},32:function(){if(GAME.is("choice"))return GAME.functions.choice()},37:function(a){return GAME.functions.direction.down(a)},38:function(a){return GAME.is("choice")?GAME.functions.choice(38):GAME.functions.direction.down(a)},39:function(a){return GAME.functions.direction.down(a)},40:function(a){return GAME.is("choice")?GAME.functions.choice(40):GAME.functions.direction.down(a)},48:function(a){GAME.sound.enabled?GAME.sound.mute():GAME.sound.unmute()},68:function(a){GAME.is("message")?
GAME.message():GAME.is("choice")?GAME.functions.choice():(GAME.functions.interact(),GAME.keys.up({keyCode:68}))},82:function(a){window.location.reload()},83:function(a){"number"==typeof GAME.characters[0].speed.run&&(GAME.characters[0].running=!0);GAME.is("choice")?GAME.functions.choice(null):GAME.is("message")?GAME.message():"Phantom"==GAME.characters[0].character&&GAME.characters[0].canBeInvisible&&(GAME.characters[0].invisible=!0,GAME.characters[0].displayStep(),GAME.timeouts.phantomInvisible=
setTimeout("GAME.keys.up({keyCode: 83});",GAME.characters[0].speed.invisibility))},96:function(){GAME.sound.enabled?GAME.sound.mute():GAME.sound.unmute()},187:function(a){GAME.sound.volume(25)},189:function(a){GAME.sound.volume(-25)}},up:{37:function(a){return GAME.functions.direction.up(a)},38:function(a){return GAME.is("choice")?clearTimeout(GAME.timeouts.choice):GAME.functions.direction.up(a)},39:function(a){return GAME.functions.direction.up(a)},40:function(a){return GAME.is("choice")?clearTimeout(GAME.timeouts.choice):
GAME.functions.direction.up(a)},83:function(a){GAME.characters[0].running=!1;"Phantom"==GAME.characters[0].character&&(GAME.characters[0].canBeInvisible=!1,GAME.characters[0].invisible=!1,GAME.characters[0].displayStep(),clearTimeout(GAME.timeouts.phantomInvisible),GAME.map.timeouts.phantomCanBeInvisible=setTimeout("GAME.characters[0].canBeInvisible = true;",GAME.characters[0].cooldowns.invisibility))}}},codes:{8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",20:"capsLock",27:"esc",32:" ",33:"pageUp",
34:"pageDown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",48:0,49:1,50:2,51:3,52:4,53:5,54:6,55:7,56:8,57:9,65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",91:"windows",93:"rightClick",96:0,97:1,98:2,99:3,100:4,101:5,102:6,103:7,104:8,105:9,107:"=",109:"-",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",
121:"F10",122:"F11",123:"F12",144:"numLk",186:";",188:",",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},down:function(a){if(!GAME.keys.active[a.keyCode]&&(GAME.keys.active[a.keyCode]=!0,"function"==typeof GAME.keys.binds.down[a.keyCode]))GAME.keys.binds.down[a.keyCode](a.keyCode)},up:function(a){GAME.keys.active[a.keyCode]=!1;if("function"==typeof GAME.keys.binds.up[a.keyCode])GAME.keys.binds.up[a.keyCode](a.keyCode)}},onresize:function(){GAME.$debugWrapper.height(GAME.$window.height()+
"px").width((GAME.$window.width()-GAME.$gamengine.width()-1)/2+"px");GAME.$gamengine.css("margin-top",(GAME.$window.height()-GAME.$gamengine.height())/2+"px")},load:function(a){"function"==typeof a.callback&&(GAME.map.callback=a.callback);GAME.onresize();GAME.$window.resize(GAME.onresize);"undefined"!=typeof a.multiplayer&&(GAME.multiplayer=a.multiplayer);GAME.characters[0]=a.character;GAME.map.load(a.map,a.character.position[0],a.character.position[1]);GAME.$document.keydown(GAME.keys.down);GAME.$document.keyup(GAME.keys.up)},
map:{callback:null,clearTimeouts:function(){var a=0,b;for(b in GAME.map.timeouts)a++,clearTimeout(GAME.map.timeouts[b]),delete GAME.map.timeouts[b];GAME.debug("Cleared "+a+" map timeouts.");for(b=0;b<GAME.characters.length;b++){a=0;for(var c in GAME.characters[b].timeouts)clearTimeout(GAME.characters[b].timeouts[c]),a++;GAME.debug("Cleared "+a+" timeouts for character #"+b+".")}},current:null,empty:function(){GAME.debug("Emptying map.");GAME.$gamengine.empty();GAME.map.clearTimeouts();for(var a=1;a<
GAME.characters.length;a++)GAME.characters.pop()},load:function(a,b,c,d){GAME.doing.preload=!0;"number"==typeof b&&"number"==typeof c&&(GAME.characters[0].position=[b,c],GAME.data.mapMusic="undefined"==typeof d?!1:!0);if("object"==typeof GAME.map.maps[a])return GAME.debug("Loading map: <strong>"+a+"</strong>"),GAME.map.empty(),GAME.map.current=a,GAME.$gamengine.css("background-color",GAME.map.maps[a].color),GAME.preload(function(){for(var b=GAME.map.maps[GAME.map.current],c=0;c<b.overlays.length;c++)"boolean"==
typeof b.overlays[c]?GAME.character(GAME.characters[0],c):(b.overlays[c]=$.extend({$:{},offset:[0,0],parallax:[1,1],repeat:"no-repeat"},b.overlays[c]),GAME.debug("Creating overlay #"+(c+1)+': <a href="'+GAME.url+"images/maps/"+GAME.timeOfDay(!0)+"/"+b.overlays[c].image+'">'+b.overlays[c].image+"</a>"),GAME.$gamengine.append('<div class="overlay" id="overlay-'+(c+1)+'"></div>'),b.overlays[c].$=$("#overlay-"+(c+1)),b.overlays[c].$.css({backgroundImage:'url("'+GAME.url+"images/maps/"+GAME.timeOfDay(!0)+
"/"+b.overlays[c].image+'")',backgroundPosition:312-GAME.characters[0].position[0]*b.overlays[c].parallax[0]*GAME.map.maps[GAME.map.current].block+"px "+(232-GAME.characters[0].position[1]*b.overlays[c].parallax[1]*GAME.map.maps[GAME.map.current].block)+"px",backgroundRepeat:b.overlays[c].repeat,zIndex:1E3*c}));GAME.data.mapMusic||GAME.sound.stop();"function"==typeof GAME.map.maps[a].loaded&&GAME.map.maps[a].loaded();GAME.debug("Map loaded.");GAME.characters[0].direction.length&&GAME.characters[0].step();
GAME.map.callback&&(GAME.debug("Executing map callback."),GAME.map.callback(),delete GAME.map.callback)}),!0;GAME.debug("Downloading map: <strong>"+a+"</strong>");GAME.script("scripts/maps/"+a+".min.js");return!1},maps:{},timeouts:{}},message:function(){if(!$(".message").hasClass("hidden")){$(".message").remove();if("undefined"==typeof arguments[0]&&"undefined"==typeof GAME.data.messages[0])return GAME.doing.message=!1,"function"==typeof GAME.callbacks.message&&(GAME.debug("Executing message callback."),
GAME.callbacks.message()),!0;if(arguments.length){GAME.doing.message=!0;var a=arguments;"object"==typeof a[0]&&(a=a[0]);GAME.data.messages=[];GAME.data.messageId="number"==typeof a[0]?a[0]:null;GAME.callbacks.message=null;for(var b=null!=GAME.data.messageId?1:0;b<a.length;b++)"function"==typeof a[b]?GAME.callbacks.message=a[b]:GAME.data.messages.push(a[b]);GAME.debug("Created "+GAME.data.messages.length+" message"+(1!=GAME.data.messages.length?"s":"")+(null!=GAME.data.messageId?" for character #"+
GAME.data.messageId:"")+("function"==typeof GAME.callbacks.message?" with callback":"")+".")}a=GAME.data.messages.shift();var c=$('<div class="message"><div>'+a+"</div></div>").css({zIndex:1E3*GAME.map.maps[GAME.map.current].overlays.length});null!=GAME.data.messageId&&c.addClass("hidden");null!=GAME.data.messageId&&c.addClass(GAME.characters[GAME.data.messageId].character).css({backgroundColor:"#"+GAME.characters[GAME.data.messageId].background,borderColor:"#"+GAME.characters[GAME.data.messageId].foreground,
color:"#"+GAME.characters[GAME.data.messageId].foreground});GAME.$gamengine.append(c);if(null!=GAME.data.messageId){var d=GAME.url+"images/message/"+GAME.characters[GAME.data.messageId].character+"/"+GAME.characters[GAME.data.messageId].background+"-"+c.height()+".jpg";GAME.preloader.quick(d,function(){c.css("background-image",'url("'+d+'")');c.removeClass("hidden")})}return!0}return!1},multiplayer:!1,notice:function(a){$("#notice").remove();GAME.debug("Notice: "+a);GAME.$notice=$('<div id="notice">'+
a+"</div>").fadeTo(0,0).boxShadow(12,12,12,"#202020");GAME.$gamengine.append(GAME.$notice);GAME.$notice.css({marginRight:"-"+GAME.$notice.outerWidth()+"px",zIndex:1E3*GAME.map.maps[GAME.map.current].overlays.length});GAME.$notice.fadeTo(500,1,function(){GAME.map.timeouts.notice=setTimeout(function(){GAME.$notice.fadeTo(500,0,function(){GAME.$notice.remove()})},2E3)})},percent:function(a,b){return Math.round(a/b*1E4)/100+"%"},preload:function(a){GAME.doing.preload=!0;var b=[],c=GAME.map.maps[GAME.map.current];
b.push(GAME.url+"images/characters/"+GAME.timeOfDay(!0)+"/"+GAME.characterSettings[GAME.characters[0].character].image);b.push("./images/preloader/round.gif");b.push("./images/preloader/bar.gif");b.push("./images/preloader/item.gif");if("object"==typeof c.overlays)for(x=0;x<c.overlays.length;x++)"string"==typeof c.overlays[x].image&&b.push(GAME.url+"images/maps/"+GAME.timeOfDay(!0)+"/"+c.overlays[x].image);if(GAME.sound.supported&&"object"==typeof c.sound)for(x=0;x<c.sound.length;x++){var d=c.sound[x].match(/\/?([\d\-\.\w]+?)\.(?:mid|mp3|ogg|wav)$/)[1];
soundManager.getSoundById(d)||b.push("./sound/"+c.sound[x])}if("object"==typeof c.imgs)for(x=0;x<c.imgs.length;x++)b.push("./images/"+c.imgs[x]);GAME.preloader.load(b,"function"==typeof a?a:null)},preloader:{callback:null,checkpoint:0,complete:function(){GAME.doing.preload=!1;"function"==typeof GAME.preloader.callback&&GAME.preloader.callback()},delay:0,done:0,faux:function(){var a=GAME.preloader.totalBytes/GAME.preloader.totalTime*((new Date).getTime()-GAME.preloader.started);a=Math.min(a,GAME.preloader.thus+
GAME.preloader.todo[GAME.preloader.done][1]);var b=GAME.percent(a,GAME.preloader.total);GAME.preloader.$bar2.width(b);GAME.preloader.$percent.html(b);GAME.preloader.$thus.html(GAME.format(Math.round(a)));GAME.preloader.timeouts[1]=setTimeout(GAME.preloader.faux,20)},init:function(a){GAME.preloader.todo=a;GAME.preloader.started=(new Date).getTime();GAME.preloader.checkpoint=GAME.preloader.started;for(a=0;a<GAME.preloader.todo.length;a++)GAME.preloader.total+=GAME.preloader.todo[a][1];GAME.preloader.$total.html("<span>0</span> / "+
GAME.format(GAME.preloader.total));GAME.preloader.$thus=GAME.preloader.$total.children("span").first();GAME.preloader.next()},load:function(a,b){GAME.doing.preload=!0;GAME.preloader.callback="function"==typeof b?b:null;for(var c=[],d=0;d<a.length;d++)GAME.preloader.past.contains(a[d])||c.push(a[d]);if(c.length){GAME.preloader.done=0;GAME.preloader.thus=0;GAME.preloader.total=0;GAME.$gamengine.append('<div id="preloader"><div id="preloader-area"></div><div id="preloader-bar1"><div id="preloader-bar2"></div></div><div id="preloader-round"></div><div id="preloader-items"></div><div id="preloader-total">Loading...</div><div id="preloader-percent">0%</div></div>');
GAME.$preloader=$("#preloader");GAME.preloader.$area=$("#preloader-area");GAME.preloader.$bar1=$("#preloader-bar1");GAME.preloader.$bar2=$("#preloader-bar2");GAME.preloader.$items=$("#preloader-items");GAME.preloader.$percent=$("#preloader-percent");GAME.preloader.$total=$("#preloader-total");for(d=0;d<c.length;d++)GAME.preloader.$items.append('<div class="preloader-item loading"></div>');GAME.preloader.scroll();GAME.preloader.init(c.map(fileSizeDotPhp))}else GAME.preloader.complete()},loaded:function(){var a=
(new Date).getTime();GAME.preloader.totalBytes+=GAME.preloader.todo[GAME.preloader.done][1];GAME.preloader.totalTime+=a-GAME.preloader.checkpoint;GAME.preloader.past.pushUnique(GAME.preloader.todo[GAME.preloader.done][0]);GAME.preloader.done++;GAME.preloader.checkpoint=a;1==GAME.preloader.done&&GAME.preloader.faux();GAME.preloader.thus+=GAME.preloader.todo[GAME.preloader.done-1][1];GAME.preloader.$thus.html(GAME.format(GAME.preloader.thus));GAME.preloader.$items.children(".loading:first").removeClass("loading").addClass("loaded");
a=GAME.percent(GAME.preloader.thus,GAME.preloader.total);GAME.preloader.$bar2.width(a);GAME.preloader.$percent.html(a);GAME.preloader.done==GAME.preloader.todo.length?(clearTimeout(GAME.preloader.timeouts[0]),clearTimeout(GAME.preloader.timeouts[1]),GAME.$preloader.remove(),GAME.preloader.complete()):(GAME.preloader.$bar2.css("max-width",GAME.percent(GAME.preloader.thus+GAME.preloader.todo[GAME.preloader.done][1],GAME.preloader.total)),setTimeout(GAME.preloader.next,GAME.preloader.delay))},next:function(){var a=
GAME.preloader.todo[GAME.preloader.done][0];if(id=a.match(/\/([\d\-\.\w]+?)\.(?:mid|mp3|ogg|wav)$/))if(GAME.debug("Loading sound: "+a),GAME.sound.supported&&!soundManager.getSoundById(id[1])){if(author=a.match(/\/by\/([\d\-\.\w]+)\/[\d\-\.\w]+\.(?:mid|mp3|ogg|wav)$/))GAME.sound.authors[id[1]]=author[1];soundManager.createSound({id:id[1],url:a,autoLoad:!0,autoPlay:!1,onfinish:function(){this.loop&&GAME.sound.play(this.sID,!0)},onload:GAME.preloader.loaded,volume:GAME.sound.volumeLevel}).loop=!0}else GAME.preloader.loaded();
else{GAME.debug('Loading image: <a href="'+a+'">'+a.replace(new RegExp("^"+GAME.url.replace(/\./g,"\\.").replace(/\//g,"\\/")),"./")+"</a>");var b=document.createElement("img");b.onload=GAME.preloader.loaded;b.setAttribute("src",a);GAME.preloader.$area.append(b)}},past:[],quick:function(){GAME.preloader.todo=[];for(var a=null,b=0;b<arguments.length;b++)"function"==typeof arguments[b]?a=arguments[b]:GAME.preloader.past.contains(arguments[b])||GAME.preloader.todo.push(arguments[b]);GAME.preloader.callback=
a;if(GAME.preloader.todo.length)for(GAME.doing.preload=!0,GAME.preloader.quickTotal=0,GAME.$gamengine.append('<div id="preloader-area"></div><img alt="Loading..." height="16" id="preloader-quick" src="./images/preloader/quick7.gif" width="16" />'),GAME.preloader.$area=$("#preloader-area"),GAME.preloader.$quick=$("#preloader-quick").css({zIndex:1E3*GAME.map.maps[GAME.map.current].overlays.length}).slide(GAME.$gamengine.width()/2-8,GAME.$gamengine.height()/2-8),b=0;b<GAME.preloader.todo.length;b++)GAME.debug('Quick loading image: <a href="'+
GAME.preloader.todo[b]+'">'+GAME.preloader.todo[b].replace(new RegExp("^"+GAME.url.replace(/\./g,"\\.").replace(/\//g,"\\/")),"./")+"</a>"),a=document.createElement("img"),a.onload=GAME.preloader.quickLoaded,a.setAttribute("src",GAME.preloader.todo[b]),GAME.preloader.$area.append(a);else GAME.preloader.complete()},quickLoaded:function(){GAME.preloader.past.push(GAME.preloader.todo[GAME.preloader.quickTotal]);GAME.preloader.quickTotal++;GAME.preloader.quickTotal==GAME.preloader.todo.length&&(GAME.preloader.$area.remove(),
GAME.preloader.$quick.remove(),GAME.preloader.complete())},quickTotal:0,scroll:function(){GAME.preloader.$bar1.scroll(2,0);GAME.preloader.$bar2.scroll(2,0);GAME.preloader.timeouts[0]=setTimeout(GAME.preloader.scroll,100)},started:0,thus:0,timeouts:[0,0],todo:[],total:0,totalBytes:0,totalTime:0},random:function(a,b){"undefined"==typeof b&&(b=a,a=0);return Math.floor(Math.random()*(b-a+1))+a},say:function(a,b,c){if(GAME.is("choice","message"))return setTimeout(function(){GAME.say(a,b,c)},100);$(".say-"+
a).remove();"string"==typeof b[2*c]?GAME.preloader.quick(GAME.url+"images/say/corner/"+GAME.characters[a].background+"-"+GAME.characters[a].foreground+".gif",GAME.url+"images/say/horizontal/"+GAME.characters[a].background+"-"+GAME.characters[a].foreground+".gif",GAME.url+"images/say/stem/"+GAME.characters[a].background+"-"+GAME.characters[a].foreground+".gif",GAME.url+"images/say/vertical/"+GAME.characters[a].background+"-"+GAME.characters[a].foreground+".gif",function(){var d=0==a||GAME.characters[0].position[0]<
GAME.characters[a].position[0]?"left":"right";GAME.$gamengine.append('<div class="say say-'+a+'"><div class="horizontal top"></div><span class="text">'+b[2*c]+'</span><div class="vertical left"></div><div class="vertical right"></div><div class="horizontal bottom"></div><div class="corner one"></div><div class="corner two"></div><div class="corner three"></div><div class="corner four"></div><div class="stem '+d+'"></div></div>');var e=$(".say-"+a),f=e.children(".text"),g=GAME.characters[1].position[0]-
GAME.characters[0].position[0],h=GAME.characters[1].position[1]-GAME.characters[0].position[1],k=Math.round(GAME.$gamengine.width()/GAME.map.maps[GAME.map.current].block),l=Math.round(GAME.$gamengine.height()/GAME.map.maps[GAME.map.current].block);f.css("font-size",14-Math.round(Math.sqrt(g*g+h*h)/Math.round(Math.sqrt(k*k+l*l))*10)+"px");e.children(".horizontal").width(f.width()-1);e.children(".vertical").height(f.height()-1);e.css({left:(320+(GAME.characters[a].position[0]-GAME.characters[0].position[0])*
GAME.map.maps[GAME.map.current].block+GAME.characters[0].offset[0]+GAME.characters[a].offset[0]-(f.width()+11)/2+("left"==d?-1:1)*GAME.characters[a].width).toString()+"px",marginBottom:"-"+(f.height()+12).toString()+"px",top:(240-Math.round(GAME.characters[a].height/2)+GAME.characters[a].offset[1]+(0==a?0:(GAME.characters[a].position[1]-GAME.characters[0].position[1])*GAME.map.maps[GAME.map.current].block)+GAME.characters[0].offset[1]-f.height()-37).toString()+"px",zIndex:1E3*GAME.map.maps[GAME.map.current].overlays.length}).height(f.height()+
11).width(f.width()+11);e.children(".stem").css("left",e.width()/2-("left"==d?11:GAME.characters[a].width/2)+"px");f.css({backgroundColor:"#"+GAME.characters[a].background,color:"#"+GAME.characters[a].foreground});d=["corner","horizontal","stem","vertical"];for(e=0;4>e;e++)$(".say ."+d[e]).css("background-image",'url("'+GAME.url+"images/say/"+d[e]+"/"+GAME.characters[a].background+"-"+GAME.characters[a].foreground+'.gif")');"number"==typeof b[2*c+1]&&(GAME.characters[a].timeouts.say=setTimeout(function(){GAME.say(a,
b,c+1)},b[2*c+1]))}):"function"==typeof b[2*c]&&(GAME.debug("Executing say callback."),b[2*c]())},script:function(a,b){GAME.debug('<a href="'+GAME.url+a+'">'+a+"</a>");"string"==typeof b&&document.getElementById(b)&&GAME.$head.remove("#"+b);var c=document.createElement("script");c.setAttribute("src",GAME.url+a);c.setAttribute("type","text/javascript");c.onload=function(){GAME.$head.remove(this)};GAME.$head.append(c)},settings:{},sound:{authors:{},destroy:function(){for(;soundManager.soundIDs.length;)GAME.debug("Destroying sound: "+
soundManager.soundIDs[0]),soundManager.destroySound(soundManager.soundIDs[0])},enabled:!1,mute:function(){GAME.sound.supported&&(GAME.sound.enabled=!1,soundManager.mute(),GAME.debug("Muted."))},play:function(a,b){GAME.sound.supported&&1!=soundManager.getSoundById(a).playState&&(soundManager.play(a),"undefined"!=typeof b?!b&&soundManager.getSoundById(a)&&(soundManager.getSoundById(a).loop=!1):(GAME.debug("Playing "+a),a in GAME.sound.authors&&GAME.preloader.quick("./images/notice/music/000000.gif",
function(){GAME.notice('<img alt="Music" height="12" src="./images/notice/music/000000.gif" width="13" /> &nbsp; &quot;'+a.replace(/_/g," ")+"&quot; by "+GAME.sound.authors[a].replace(/_/g," "))})))},ready:function(){GAME.debug("Sound Manager loaded.");GAME.sound.enabled=!0;GAME.sound.supported=!0;GAME.debug("Engine starting.");GAME.start()},stop:function(){for(var a=0;a<soundManager.soundIDs.length;a++)soundManager.getSoundById(soundManager.soundIDs[a]).stop()},supported:!1,timeout:function(){GAME.debug('<strong class="error">Error loading Sound Manager.</strong>');
GAME.sound.enabled=!1;GAME.sound.supported=!1;GAME.start()},unmute:function(){GAME.sound.supported&&(GAME.sound.enabled=!0,soundManager.unmute(),GAME.debug("Unmuted."))},volume:function(a){var b=GAME.sound.volumeLevel;GAME.sound.volumeLevel+=a;GAME.sound.volumeLevel=Math.min(Math.max(GAME.sound.volumeLevel,0),100);if(GAME.sound.volumeLevel!=b)for(GAME.debug((0>a?"De":"In")+"creasing volume to "+GAME.sound.volumeLevel+"%."),a=0;a<soundManager.soundIDs.length;a++)soundManager.setVolume(soundManager.soundIDs[a],
GAME.sound.volumeLevel)},volumeLevel:100},timeOfDay:function(a){"undefined"==typeof a&&(a=!1);var b=(new Date).getHours();return 4<=b&&8>b?a?66:"dawn":8<=b&&16>b?a?75:"day":16<=b&&20>b?a?66:"dusk":a?33:"night"},timeouts:{},url:"./",start:function(){GAME.load({character:{character:"Red",facing:3,name:"Charles Stover",position:[2,6]},map:"room1",multiplayer:!0})}};window.soundManager.debugMode=!1;window.soundManager.flashVersion=8;window.soundManager.onready(GAME.sound.ready);window.soundManager.ontimeout(GAME.sound.timeout);
window.soundManager.url="./scripts/";window.soundManager.useFlashBlock=!1;
